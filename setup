if ((gc $PROFILE -raw) -match '\n# set profile\.d') {Write-Host 'profile.d already set'; return}

"`n# set profile.d, see https://github.com/majkinetor/powershell_profile.d
ls '$pwd\powershell_profile.d\*.ps1' | % { . `$_.FullName } # 3>`$null
" | Out-File -Encoding ascii -Append $PROFILE